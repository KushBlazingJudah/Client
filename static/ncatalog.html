{{ define "header" }}
<script src="/static/js/posts.js"></script>
{{ end }}

{{ define "content" }}
{{ $board := .Board }}
<div style="margin: 0 auto; width: 400px; margin-bottom: 100px;">
  <h1 style="color: #af0a0f;">/{{ $board.Name }}/ - {{ $board.PrefName }}</h1>
  <p>{{ $board.Summary }}</p>  
  <!--      <form id="new-post" action="{{ $board.To }}" method="post" enctype="multipart/form-data"> -->
    <form id="new-post" action="/post" method="post" enctype="multipart/form-data">        
      <label for="name">Name:</label><br>
      <input type="text" id="name" name="name" placeholder="Anonymous"><br>
      <label for="options">Options:</label><br>
      <input type="text" id="options" name="options"><input type="submit" value="Post"><br>
      <label for="comment">Comment:</label><br>
      <textarea rows="10" cols="50" id="comment" name="comment"></textarea><br>
      <input type="hidden" id="inReplyTo" name="inReplyTo" value="{{ $board.InReplyTo }}">
      <input type="hidden" id="sendTo" name="sendTo" value="{{ $board.To }}">
      <input type="hidden" id="boardName" name="boardName" value="{{ $board.Name }}">
      <input type="hidden" id="captchaCode" name="captchaCode" value="{{ $board.CaptchaCode }}">                
      <input type="file" id="file" name="file" required><br><br>
      <label stye="display: inline-block;" for="captcha">Captcha:</label>
      <br>              
      <input style="display: inline-block;"  type="text" id="captcha" name="captcha"><br>
      <div style="height: 65px;">
        <img src="{{ $board.Captcha }}">
      </div>
    </form>
</div>

<hr>
<ul style="margin: 0; padding: 0; display: inline">
  <li style="display: inline"><a href="/{{ $board.Name }}">[Return]</a></li>
  <li style="display: inline"><a href="/{{ $board.Name }}/catalog">[Catalog]</a></li>      
  <li style="display: inline"><a href="#bottom">[Bottom]</a></li>
  <li style="display: inline"><a href="javascript:location.reload()">[Refresh]</a></li>
</ul>    
<hr>

<div style="padding: 10px; text-align: center;">
  {{ range .Posts }}
  <div style="overflow: hidden; vertical-align: top; margin: 0 auto; display: inline-block; width: 180px; max-height: 320px; margin-bottom: 10px;">
    {{ if $board.IsMod }}        
    <a href="/delete?id={{ .Id }}">[Delete Post]</a>
    {{ end }}
    {{ if .Attachment }}
    {{ if $board.IsMod }}        
    <a href="/deleteattach?id={{ .Id }}">[Delete Attachment]</a>
    {{ end }}        
    <a id="{{ .Id }}-anchor" href="/{{ $board.Name }}/">
      <div id="media-{{ .Id }}" style="width:180px;"></div>
      <script>
        media = document.getElementById("media-{{ .Id }}")
        if(getMIMEType({{ (index .Attachment 0).MediaType }}) == "image"){
            var img = document.createElement("img");
            img.style = "float: left; max-width: 180px; max-height: 180px; cursor: move;"
            img.setAttribute("id", "img")
            img.setAttribute("main", "1")
            img.setAttribute("src", "{{ (index .Attachment 0).Href }}")
            media.appendChild(img)
        }                                

        if(getMIMEType({{ (index .Attachment 0).MediaType }}) == "audio"){
            var audio = document.createElement("audio")
            audio.controls = 'controls'
            audio.muted    = 'muted'              
            audio.src      = '{{ (index .Attachment 0).Href }}'
            audio.type     = '{{ (index .Attachment 0).MediaType }}'              
            audio.style = "float: left; margin-right: 10px; margin-bottom: 10px; width: 180px;"
            audio.innerText = 'Audio is not supported.'
            media.appendChild(audio)                            
        }

        if(getMIMEType({{ (index .Attachment 0).MediaType }}) == "video"){
            var video = document.createElement("video")
            video.controls = 'controls'
            video.muted    = 'muted'              
            video.src      = '{{ (index .Attachment 0).Href }}'
            video.type     = '{{ (index .Attachment 0).MediaType }}'              
            video.style = "float: left; margin-right: 10px; margin-bottom: 10px; width: 180px;"
            video.innerText = 'Video is not supported.'
            media.appendChild(video)                                          
        }                    
      </script>                        
      {{ end }}
      <div>
        {{ $replies := .Replies }}
        <span style="display: block;">R: {{ $replies.TotalItems }}{{ if $replies.TotalImgs }}/ A: {{ $replies.TotalImgs }}{{ end }}</span>                        
        {{ if .Name }}
        <span style="display: block; color: #0f0c5d;"><b>{{ .Name }}</b></span>
        {{ end }}

        {{ if .Content }}
        <span style="display: block">{{.Content}}</span>
        {{ end }}

      </div>
    </a>        
  </div>
  <script>
    document.getElementById("{{ .Id }}-anchor").href = "/{{ $board.Name }}/" + shortURL("{{$board.Actor}}", "{{ .Id }}")
  </script>
  {{ end }}
</div>
<hr>
<ul style="margin: 0; padding: 0; display: inline">
  <li style="display: inline"><a href="/{{ $board.Name }}">[Return]</a></li>
  <li style="display: inline"><a id="bottom" href="#top">[Top]</a></li>
  <li style="display: inline"><a href="javascript:location.reload()">[Refresh]</a></li>
</ul>
<hr>    
{{ end }}

{{ define "script" }}
{{ end }}
